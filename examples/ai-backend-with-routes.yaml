apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: ai-gateway
spec:
  gatewayClassName: agentgateway
  listeners:
  - name: http
    port: 8080
    protocol: HTTP
---
# TODO: Update this to use the agw based Backend API.
apiVersion: gateway.kgateway.dev/v1alpha1
kind: Backend
metadata:
  name: unified-ai-backend
spec:
  type: AI
  ai:
    llm:
      anthropic:
        model: claude-sonnet-4-20250514
        authToken:
          kind: SecretRef
          secretRef:
            name: anthropic-secret
      routes:
        "/v1/chat/completions": Completions
        "/v1/messages": Messages
        "/v1/responses": Responses
        "/v1/messages/count_tokens": AnthropicTokenCount
        "/v1/realtime": Realtime
        "/v1/embeddings": Embeddings
        "/v1/models": Models
        "*": Passthrough
---
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: ai-route
spec:
  parentRefs:
  - name: ai-gateway
  rules:
  - backendRefs:
    - group: gateway.kgateway.dev
      kind: Backend
      name: unified-ai-backend
---
apiVersion: v1
kind: Secret
metadata:
  name: anthropic-secret
type: Opaque
stringData:
  x-api-key: "sk-ant-your-anthropic-key"
