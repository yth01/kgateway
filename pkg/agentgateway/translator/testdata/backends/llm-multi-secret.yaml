apiVersion: agentgateway.dev/v1alpha1
kind: AgentgatewayBackend
metadata:
  name: multipool-secret
  namespace: default
spec:
  ai:
    groups:
      - providers:
          - name: openai
            openai:
              model: "gpt-4-turbo"
            policies:
              auth:
                secretRef:
                  name: openai-secret
          - name: gemini
            gemini:
              model: "gemini-1.5-pro"
            policies:
              auth:
                secretRef:
                  name: gemini-secret
---
apiVersion: v1
kind: Secret
metadata:
  name: openai-secret
  namespace: default
type: Opaque
data:
  Authorization: QmVhcmVyIHNrLW9wZW5haS1zZWNyZXQta2V5 # Bearer sk-openai-secret-key
---
apiVersion: v1
kind: Secret
metadata:
  name: gemini-secret
  namespace: default
type: Opaque
data:
  Authorization: Z2VtaW5pLWFwaS1rZXk= # gemini-api-key
---
# Output
output:
- resource:
    backend:
      ai:
        providerGroups:
        - providers:
          - inlinePolicies:
            - auth:
                key:
                  secret: sk-openai-secret-key
            name: openai
            openai:
              model: gpt-4-turbo
          - gemini:
              model: gemini-1.5-pro
            inlinePolicies:
            - auth:
                key:
                  secret: gemini-api-key
            name: gemini
      key: default/multipool-secret
      name:
        name: multipool-secret
        namespace: default
status:
- apiVersion: agentgateway.dev/v1alpha1
  kind: AgentgatewayBackend
  metadata:
    name: multipool-secret
    namespace: default
  spec: null
  status:
    conditions:
    - lastTransitionTime: fake
      message: Backend successfully accepted
      reason: Accepted
      status: "True"
      type: Accepted
