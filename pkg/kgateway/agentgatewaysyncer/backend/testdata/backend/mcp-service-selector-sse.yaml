apiVersion: agentgateway.dev/v1alpha1
kind: AgentgatewayBackend
metadata:
  namespace: default
  name: mcp-service-selector
spec:
  mcp:
    targets:
    - name: mcp-services
      selector:
        services:
          matchLabels:
            app: mcp-server
    sessionRouting: Stateless
---
apiVersion: v1
kind: Service
metadata:
  name: mcp-service-sse
  namespace: default
  labels:
    app: mcp-server
  annotations:
    kgateway.dev/mcp-http-path: /custom-path
spec:
  ports:
  - name: mcp
    port: 8080
    appProtocol: kgateway.dev/mcp-sse
---
# Output
output:
- backend:
    key: default/mcp-service-selector
    mcp:
      statefulMode: STATELESS
      targets:
      - backend:
          port: 8080
          service:
            hostname: mcp-service-sse.default.svc.cluster.local
            namespace: default
        name: mcp-service-sse-mcp
        protocol: SSE
    name:
      name: mcp-service-selector
      namespace: default
status:
  conditions:
  - lastTransitionTime: fake
    message: Backend successfully accepted
    reason: Accepted
    status: "True"
    type: Accepted
