apiVersion: agentgateway.dev/v1alpha1
kind: AgentgatewayBackend
metadata:
  namespace: default
  name: ai-priority-with-secret
spec:
  ai:
    groups:
    - providers:
      - name: openai-secure
        openai:
          model: gpt-4o
        policies:
          auth:
            secretRef:
              name: openai-secret
      - name: anthropic-secure
        anthropic:
          model: claude-3-5-sonnet
        policies:
          auth:
            secretRef:
              name: anthropic-secret
---
apiVersion: v1
kind: Secret
metadata:
  name: openai-secret
  namespace: default
data:
  Authorization: QmVhcmVyIHRlc3Q=
---
apiVersion: v1
kind: Secret
metadata:
  name: anthropic-secret
  namespace: default
data:
  Authorization: QmVhcmVyIHRlc3Q=
---
# Output
output:
- backend:
    ai:
      providerGroups:
      - providers:
        - inlinePolicies:
          - auth:
              key:
                secret: test
          name: openai-secure
          openai:
            model: gpt-4o
        - anthropic:
            model: claude-3-5-sonnet
          inlinePolicies:
          - auth:
              key:
                secret: test
          name: anthropic-secure
    key: default/ai-priority-with-secret
    name:
      name: ai-priority-with-secret
      namespace: default
status:
  conditions:
  - lastTransitionTime: fake
    message: Backend successfully accepted
    reason: Accepted
    status: "True"
    type: Accepted
