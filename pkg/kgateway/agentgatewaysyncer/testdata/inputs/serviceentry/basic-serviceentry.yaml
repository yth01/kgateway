apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: example-gateway
  namespace: default
spec:
  gatewayClassName: agentgateway-v2
  listeners:
  - name: http
    protocol: HTTP
    port: 80
---
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: external-service-route
  namespace: default
spec:
  parentRefs:
  - name: example-gateway
  hostnames:
  - "external.example.com"
  rules:
  - backendRefs:
    - name: external.example.com
      kind: Hostname
      group: networking.istio.io
      port: 8080
---
apiVersion: networking.istio.io/v1
kind: ServiceEntry
metadata:
  name: external-service
  namespace: default
spec:
  hosts:
  - external.example.com
  location: MESH_EXTERNAL
  ports:
  - number: 8080
    name: http
    protocol: HTTP
  resolution: DNS
  endpoints:
  - address: external-backend.example.com

