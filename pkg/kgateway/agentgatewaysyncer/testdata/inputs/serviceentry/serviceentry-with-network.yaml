apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: example-gateway
  namespace: default
spec:
  gatewayClassName: agentgateway-v2
  listeners:
  - name: http
    protocol: HTTP
    port: 80
---
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: network1-gateway
  namespace: default
  labels:
    topology.istio.io/network: network1
spec:
  gatewayClassName: istio-remote
  addresses:
  - type: IPAddress
    value: 192.168.10.1
  listeners:
  - name: cross-network
    port: 15008
    protocol: HBONE
  - name: xds-tls
    port: 15012
    protocol: TLS
status:
  addresses:
  - type: IPAddress
    value: 192.168.10.1
---
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: network2-gateway
  namespace: default
  labels:
    topology.istio.io/network: network2
spec:
  gatewayClassName: istio-remote
  addresses:
  - type: IPAddress
    value: 192.168.20.1
  listeners:
  - name: cross-network
    port: 15008
    protocol: HBONE
  - name: xds-tls
    port: 15012
    protocol: TLS
status:
  addresses:
  - type: IPAddress
    value: 192.168.20.1
---
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: multi-network-route
  namespace: default
spec:
  parentRefs:
  - name: example-gateway
  hostnames:
  - "api.example.com"
  rules:
  - backendRefs:
    - name: api.example.com
      kind: Hostname
      group: networking.istio.io
      port: 8080
---
apiVersion: networking.istio.io/v1
kind: ServiceEntry
metadata:
  name: api-service
  namespace: default
spec:
  hosts:
  - api.example.com
  addresses:
  - 240.240.0.10
  location: MESH_INTERNAL
  ports:
  - number: 8080
    name: http
    protocol: HTTP
  resolution: STATIC
  endpoints:
  - address: 10.0.0.100
    network: network1
    locality: us-west/zone1
    serviceAccount: api-service
    ports:
      http: 8080
    labels:
      app: api-service
      version: v1
      security.istio.io/tlsMode: istio
  - address: 10.0.1.100
    network: network2
    locality: us-east/zone1
    serviceAccount: api-service
    ports:
      http: 8080
    labels:
      app: api-service
      version: v1
      security.istio.io/tlsMode: istio

